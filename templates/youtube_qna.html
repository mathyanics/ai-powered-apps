{% extends "base.html" %}

{% block title %}YouTube Q&A - QnA with Datasets{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <h1 class="mb-4">ðŸ“º Chat with YouTube Video</h1>
        <p class="text-muted">Powered by BAAI/bge-m3 (Embeddings) and Custom LLM Engine</p>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <div class="card mb-4">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0"><i class="bi bi-youtube"></i> YouTube Video URL</h5>
            </div>
            <div class="card-body">
                <form id="youtubeForm">
                    <div class="mb-3">
                        <label for="videoUrl" class="form-label">
                            <i class="bi bi-link-45deg"></i> YouTube Video URL
                        </label>
                        <input type="url" class="form-control" id="videoUrl" placeholder="https://www.youtube.com/watch?v=..." required autocomplete="off">
                        <div class="form-text">
                            <i class="bi bi-info-circle"></i> Paste any YouTube video URL to analyze its content
                        </div>
                    </div>
                    <button type="submit" class="btn btn-danger">
                        <i class="bi bi-play-circle-fill"></i> Analyze Video Content
                    </button>
                </form>
                
                <div id="videoPreview" class="mt-3"></div>
            </div>
        </div>
    </div>
</div>

<div class="row" id="youtubeQaSection" style="display: none;">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="bi bi-chat-dots"></i> Ask About the Video</h5>
            </div>
            <div class="card-body">
                <div id="ytChatMessages" class="chat-container mb-3" style="height: 400px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 5px; padding: 15px;">
                </div>
                
                <form id="ytQuestionForm">
                    <div class="input-group">
                        <input type="text" class="form-control" id="ytQuestionInput" placeholder="What would you like to know about this video? (Press Enter to send)" required autocomplete="off">
                        <button type="submit" class="btn btn-success">
                            <i class="bi bi-send-fill"></i> Send
                        </button>
                    </div>
                    <small class="form-text text-muted mt-1">
                        <i class="bi bi-lightbulb"></i> Tip: Ask about specific topics mentioned in the video
                    </small>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <div class="alert alert-warning">
            <h5><i class="bi bi-exclamation-triangle"></i> Note:</h5>
            <p class="mb-0">This feature requires a HuggingFace API token and OpenAI API key. Make sure they are configured in your .env file.</p>
        </div>
    </div>
</div>

<div id="ytLoadingSpinner" class="text-center mt-3" style="display: none;">
    <div class="spinner-border text-danger" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Processing video...</p>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/youtube_qna.js') }}"></script>
{% endblock %}
